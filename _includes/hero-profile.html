{% include base_path %}

{% if page.author and site.data.authors[page.author] %}
  {% assign author = site.data.authors[page.author] %}
{% else %}
  {% assign author = site.author %}
{% endif %}

<div class="hero-frame">
  <div class="hero-section">
    <div class="hero-content">
      <div class="hero-left">
        <div class="hero-avatar">
          {% if author.avatar contains "://" %}
            <img src="{{ author.avatar }}" alt="{{ author.name }}" />
          {% else %}
            <img src="{{ author.avatar | prepend: "/images/" | prepend: base_path }}" alt="{{ author.name }}" />
          {% endif %}
        </div>

        <div class="hero-info">
          <h1 class="hero-name">{{ author.name }}</h1>
          {% assign hero_title = author.hero_title %}
          {% assign affiliation_main = author.affiliation_main %}
          {% assign affiliation_secondary = author.affiliation_secondary %}
          {% assign hero_location = author.hero_location %}

          {% if hero_title %}
            <p class="hero-title">{{ hero_title }}</p>
          {% endif %}

          {% if affiliation_main or affiliation_secondary or hero_location %}
            <p class="hero-affiliation">
              {% if affiliation_main %}
                <span class="affiliation-main">{{ affiliation_main }}</span>{% if affiliation_secondary %} |{% endif %}
              {% endif %}
              {% if affiliation_secondary %}
                <span class="affiliation-secondary">{{ affiliation_secondary }}</span>
              {% endif %}
              {% if hero_location %}
                {% if affiliation_main or affiliation_secondary %}<br>{% endif %}
                <span class="hero-location"><i class="fas fa-map-marker-alt"></i> {{ hero_location }}</span>
              {% endif %}
            </p>
          {% endif %}

          {% assign hero_links = author.hero_links | default: site.author.hero_links %}
          {% if hero_links %}
          <div class="hero-social">
            {% for link in hero_links %}
              {% assign field_key = link.field | default: '' %}
              {% if field_key != '' %}
                {% assign field_value = author[field_key] %}
              {% endif %}
              {% if field_value %}
                {% assign final_url = field_value %}
                {% if link.url %}
                  {% assign final_url = link.url | replace: '{{ value }}', field_value %}
                {% elsif link.prefix %}
                  {% assign final_url = link.prefix | append: field_value %}
                {% elsif field_key == 'email' %}
                  {% assign final_url = 'mailto:' | append: field_value %}
                {% endif %}
                {% assign external = link.external | default: true %}
                {% if field_key == 'email' and link.external == nil %}
                  {% assign external = false %}
                {% endif %}
                <a href="{{ final_url }}"
                   title="{{ link.label }}"
                   aria-label="{{ link.label }}"
                   {% if external %}target="_blank" rel="noopener"{% endif %}>
                  <i class="{{ link.icon }}"></i>
                </a>
              {% endif %}
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

{% include hero-nav.html %}

<div id="hero-condense-sentinel" class="hero-condense-sentinel" aria-hidden="true"></div>
