{% assign project = include.item %}
{% assign show_meta = include.show_meta | default: true %}
{% assign teaser_path = project.header.teaser | default: project.teaser %}
{% assign link_url = include.link_url | default: '' %}
{% assign default_label = 'View ' | append: project.title %}
{% assign link_label = include.link_label | default: default_label %}

<article class="project-row">
  {% if teaser_path %}
    {% if link_url != '' %}
      <a class="project-row__image" href="{{ link_url }}" {% if include.link_external %}target="_blank" rel="noopener"{% endif %}>
        <img
          src="{{ teaser_path | relative_url }}"
          alt="{{ project.header.alt | default: project.title }}"
          loading="lazy">
      </a>
    {% else %}
      <div class="project-row__image">
        <img
          src="{{ teaser_path | relative_url }}"
          alt="{{ project.header.alt | default: project.title }}"
          loading="lazy">
      </div>
    {% endif %}
  {% else %}
    <div class="project-row__image project-row__image--placeholder" aria-hidden="true">
      <span class="project-row__placeholder-text">No image</span>
    </div>
  {% endif %}

  <div class="project-row__content">
    <h3 class="project-row__title">
      <span class="project-row__title-text">{{ project.title }}</span>
      {% if link_url != '' %}
        <a class="project-row__title-link"
           href="{{ link_url }}"
           {% if include.link_external %}target="_blank" rel="noopener"{% endif %}
           aria-label="{{ link_label }}">
          <i class="fas fa-link" aria-hidden="true"></i>
          <span class="visually-hidden">{{ link_label }}</span>
        </a>
      {% endif %}
    </h3>

    {% assign excerpt_text = project.excerpt | default: project.description %}
    {% if excerpt_text %}
      <p class="project-row__excerpt">{{ excerpt_text | markdownify | strip_html | strip }}</p>
    {% endif %}

    {% if show_meta and project.tags %}
      <p class="project-row__meta">{{ project.tags | array_to_sentence_string }}</p>
    {% endif %}

    {% if project.links %}
      <div class="project-row__links">
        {% for link in project.links %}
          <a
            class="project-row__link"
            href="{{ link.url }}"
            {% if link.external or link.url contains 'http' %}target="_blank" rel="noopener"{% endif %}>
            {{ link.label | default: "Learn more" }}
          </a>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</article>
